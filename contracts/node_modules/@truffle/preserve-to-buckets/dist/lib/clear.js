"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.clear = void 0;
async function* clear(options) {
    const { buckets, bucketKey, controls } = options;
    const task = yield* controls.step({
        message: "Clearing existing bucket contents..."
    });
    const { item: { items } } = await buckets.listPath(bucketKey, ".");
    try {
        for (const item of items) {
            if (item.name === ".textileseed")
                continue;
            // We need to await this inside the for-loop because buckets cannot
            // handle parallel deletions
            await buckets.removePath(bucketKey, item.name);
        }
        yield* task.succeed();
    }
    catch (error) {
        yield* task.fail({ error });
    }
}
exports.clear = clear;
//# sourceMappingURL=clear.js.map