"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.connect = void 0;
const hub_1 = require("@textile/hub");
async function* connect(options) {
    const { key, secret, bucketName, controls } = options;
    const { step } = controls;
    const task = yield* step({
        message: `Connecting to Textile Bucket with name ${bucketName}...`
    });
    try {
        const buckets = await hub_1.Buckets.withKeyInfo({ key, secret });
        const createOrGetResult = await buckets.getOrCreate(bucketName);
        const bucketKey = createOrGetResult.root.key;
        yield* task.succeed({
            result: bucketKey,
            message: `Connected to Textile bucket with key ${bucketKey}`
        });
        return { buckets, bucketKey };
    }
    catch (error) {
        yield* task.fail({ error });
    }
}
exports.connect = connect;
//# sourceMappingURL=connect.js.map